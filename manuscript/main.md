#Introduction
Plant phenology has a long history in ecological research and is a primary indicator of climate change [@chuine2017, @scheffers2016]. Studies commonly document the long-term trends of first flower or leaf out dates, apply various modelling approaches to infer the drivers of these transitions, or make forecasts using future climate conditions. Phenology models, such as predictive models or those used for long term trends, use the transition dates as the variable of interest. Common transition dates are leaf out and first flowering, but can also include peak flower, fruit maturation, and leaf senescence. Historic datasets rely on observers ability to discern the true transition date [@davis2015, @wokovich2012], yet this is susceptible to observer bias [@denny2014]. Recent studies and collection protocols emphasize status based monitoring, where observers record the current state of a plant (ie. leaves present or absent) regardless of recent or impending transitions. This includes research using herbarium records, where the presence or absence of flowers and other phenophases can be inferred based on whether they are present on a specimen [@willis2017]. To make use of status based data in most phenology models the transition date must first be estimated using several available methods. 

Two of the most common estimators are First Occurrence Day (FOD) and Mean Occurrence Day (MOD) [@willis2017]. FOD has shown to be bias in several instances, while MOD is considered a reliable estimator for the midpoint of a phenophase [@miller-rushing2008, moussus2010, @bertin2015]. Recently more robust methods have been introduced. -@templ2017 used survival modelling to estimate the median date of flowering. -@pearse2017 used an extinction model to estimate the first flowering transition date and showed it provided more reliable estimates than the FOD method. Using repeated observations of individual plants allows for a more reliable estimate of FOD by utilizing observations where a phenophase is observed to be absent (ie. flowers not present) [@gerst2016], though absence observations are not available in all datasets. Studies of bird migration phenology face similar challenges and several estimators have been used to model the first arrival dates. Examples include logistic regression [@mayor2017] and General Additive Models (GAMs) [@moussus2009, @newson2017, @linden2017]. To date no comparison has been made of these different transition date estimators for plant phenology. 

Furthermore, there is no clear framework for using the estimators across different scales. Over a latitudinal gradient the transition of a phenophase for a single species can last several weeks, and even at the local scale can vary due to many factors [@diez2012, @zhang2017]. Estimates of transition dates have used observations from individual plants [@gerst2016, @taylor2018], sites or populations of plants [most papers], or entire regions [herb data papers]. How different phenology estimators perform across across scales is currently unknown. 


A comparison of estimators is difficult since, due to infrequent sampling, the true date of transitions is rarely known. Previously -@moussus used simulated phenological data to test the ability of 10 different estimators to detect the shifts in phenology distributions. Here I compare XX different estimators, XX not compared by -@moussus2010, using a recently published dataset where, due to the unique physiology of the focal species, transition dates and other metrics are known. I compare estimators across two different scales (population and individual level transition dates), with varying sample sizes, and with varying proportions of observed flower presence.


-@pearse2017 introduced a method based on extinction theory to estimate the first occurrence and showed it provided more reliable estimates of first flowering than the FOD using herbarium records. -@templ2017 used survival modelling to estimate the median date of flowering, where flower presence was analogous to death in a Kaplan-Meier Curves and Cox Proportional Hazard Models. 

#Methods
## Phenology Data
I used a dataset of phenology observations of the perennial forb Echinacea angustifolia collected in Minnesota, U.S.A. in the years 1995-2015 [@waananen2018a, @waananen2018b]. The sampling frequency was at most every 3 days during this period. The flowering of E. angustifolia florets is such that the true start date of flowering can be inferred very precisely for an individual plant. The flowering heads of E. angustifolia consist of xx-xx disk flowers in xx-xx rows. The bottom most row flowers first, with each adjacent row every day thereafter. This pattern can be used to determine the exact date of first flowering for an individual [@wagenius2004]. With this information the true start and date of flowering for the entire population monitored can be calculated. 

For each year I calculated the following population level metrics from the phenology observations: 1) The start of flowering as defined by the Julian day of the first observed flower, 2) peak flower defined as the Julian when the most flowers were observed in a given year, 3) the end of flowering as defined by the last day a flower was observed. I also calculated two  individual level metrics: 1) the start and 2) end day of flowering. 

To simulate status based observations of a plant population I randomly sampled observations of individual plants from throughout the year, thus an observation could be of flowers present or absent. For every year I repeated this 1000 times with varying sample sizes (10, 50, and 100 observation) and varying levels of flowering presence being observed (25%, 50%, and 75%). For example, with flowering presence set to 25% using 100 observations only 25 observations were allowed to be of flower presence while the rest were of flower absence, all which being randomly chosen. The variation in sample size and ratio of flowering presence observations are designed to simulate patterns seen in non-systematic phenology datasets such as the those from herbarium records or volunteer contributions. These patterns stem from biases in the time of year of sampling, infrequent or sporadic sampling, or variations in observer effort [@dickinson2010, @willis2017]. 

For individual level flowering estimates I performed the same random sampling routine for every individual in every year using sample sizes of 5, 10, and 20 observations, and flowering presence ratios of 25%, 50%, and 75%. I only used individuals which where in flower for more than XX days, since below that there would not be enough data in the lowest sample size and flowering presence classes. As in the population mod

The random sampling was repeated 100 (1000?) times for each combination of sample size and percent of in-flower observations. Each estimator, described below, was fit to each random sample to generate an estimate of first, peak, or end of flowering for the entire po

The First Flower Date (FFD) used the first observed in flower observation as the estimate for the start of flowering. Analogous to this is the last observed flowering for estimating the Last Flower Date (LFD) for the end of flowering. These are used in both the population and individual level analysis.  
The Midway Method uses the midway point between the first observed flowering date and the most recent observation of flowering absence for an individual plant. This can improved by applying a restriction whereas only individuals with an observed absence within 7 days of the first observed presence are used [@gerst2016]. Applying this restriction reduces the overall sample size though. The Midway Method was used to estimate end and onset in the individual analysis (Midway and Midway 7-Day), and in the population analysis by using the mean onset date from all individuals (Meand Midway and Mean Midway 7-Day). For all cases I noted the rate at which this could not be calculated due to inadequate sampling.

The Weibull method fits a Weibull distribution to only the flowering presence observations. The estimated date of first flowering is the sum of the dates of all flowering weighted by the joint Weibull distribution [@pearse2017, xxx]. Code for this was obtained from -@pearse2017 and is provided in the code repository. 

The Logistic method fits a generalized linear model to both presence and absence observations using a binomial distribution, where the DOY was used to explain the presence or absence of flowering (glm(flowering ~ doy, family=binomial)). Prior to fitting all flowering absence observations after the last observed flowering presence are excluded. The expected probability of observing a flower is calculated for all days 1-366, and the estimated onset of flowering is the first day in the season in which the expected probability is 0.05 or greater. The inverse of this is used to estimate of the end of flowering. All absence observations prior to the first observed flowering date are excluded, the expected probability is calculated for all days 1-366, and the first day where the probability of flowering falls below 0.05 is the estimate for the end of flowering. This method was used in both the population and individual level analysis. 

The GAM method is unique in that it can potentially estimate the full flowering phenology for a season (onset, peak, and end) which would be ideal as these different metrics tend to be correlated [xxxx]. Similar to the Logistic method, a general additive model was fit where DOY was used to explain the presence or absence of flowers, where DOY was a thin plate regression spline (glm(flowering ~ s(doy, bs=’tp’), family=binomial)).

The Survival method uses a Kaplan–Meier model to estimate the median date of “death” from observations of individuals being alive or dead at different times, where flowering presence and absence are analogous to alive or dead, respectively. I used the survfit function in the R package survival using right censoring [@Rsurvival]. This method was used to estimate peak flowering in the population analysis. 

# Results
## Population Onset Estimates
For population level flowering onset the Weibull curve method produced estimates with the  lowest error for most scenarios (Fig. 1). Excluding scenarios where the ratio of presence observations was 0.25, the Weibull curve method had R2 values from 0.39 - 0.79 and median error rates from 3-4. One exception was when the number of flowering observations was extremely low. With a sample size of 10 and percent flower present observations of 25%, thus only having 3 observations to estimate from, the Weibull Curve commonly underestimated the true onset date by up to 82 days (Fig. 1). In this scenario the FOD method had the lowest range of potential errors, but still overestimated the onset date on average (Fig. 1). 
Results from the Mean Midway 7-Day method using a sample size of 10 were excluded due to less than 1% of random samples resulting in a usable estimate. This was due to the requirement of each individual plant having at least one presence and one absence observation. 
The logistic method had the highest R2 of all methods, and similar median errors to the Weibull curve method, when the sample size was high (50-100) and ratio of flowering presence low (0.25). As the proportion of flowering presence increased, and relative amount of absences decreased, the logistic method tended to perform worse by increasingly underestimating the onset date (Fig. 1).
The Mean Midway and GAM methods were never the best performing methods. The Mean Midway method did not improve by increasing the sample size or by increasing the proportion of flowering presence observations.

## Population End Estimates
The end of flowering for the entire population was more difficult to estimate than the onset of flowering. The highest R2 for a given scenario in estimating population onset was always higher than the same scenario in population end estimates. For end estimates the Weibull curve method had the highest R2 in 4 of 9 scenarios, including all three scenarios where the proportion of flowering presence was 0.75, as well as when the proportion was 0.5 with a sample size of 10 (Fig. 2). With a sample size of 50 and 100 and a presence proportion of 0.5 the Logistic method had the highest R2. With a sample size of 50 and 100 and a presence proportion of 0.25 the GAM method had the highest R2. 
With a sample size of 10 and presence proportion of 0.25 the FOD method (here the last observed)  had the highest R2, but still underestimated the end date of flowering by 17 days the majority of the time. The Midway method, both with and without the 7-day restriction, were never the best performing estimators. Without the  7-day restriction the method consistently overestimated the end date. With the 7-day restriction the method consistently underestimated the end date. Neither Midway method improved either with increasing sample size or increasing proportion of flowering presence. 

## Population Peak Estimates
All three methods to estimate peak flowering had median error rates of 1 day except in one instance, using the GAM method for a sample size of 10 and  proportion of flower presence 0.75. The Mean Flowering method had the highest R2 in all scenarios except two where it had equal R2 with the Survival Curve method. For the Mean and Survival Curve methods, errors improved with both increasing sample size and increasing proportion of flowering presence. For the GAM method errors improved with increase sample size, but worsened with increasing proportion of flowering presence. 

## Individual Onset Estimates
The Midway 7-Day method had the best estimates in 7 of 9 scenarios. In two scenarios, when the sample size was 15 and 20 with a proportion of flowering presence observations of 0.75, the First Observed method had slightly higher R2 and lower median error rates than the Midway 7-Day method (Fig. 4). 
The Weibull Curve, Midway, Logistic, and GAM methods never produced the best estimate for any scenario in estimating individual plant flowering onset.  The Weibull Curve method did improve with increasing sample size and increasing proportion of flowering presence, though since this method does not use absence observations increasing the flowering proportion effectively just increases the sample size. At effective sample sizes of 10 or more the Weibull Curve method produced estimates only slightly worse than the Midway 7-Day and First Observed method. The Midway, Logistic, and GAM methods improved slightly with increasing sample size but worsened with increasing proportion of flowering presence. 

## Individual End Estimates
The errors from individual end estimates were fundamentally the same as the onset errors and are supplied in the supplement (Fig. SX). 

#Discussion
This comparison of phenological estimators using a dataset with known onset, peak, and end of flowering dates confirms known bias in some estimators and shows the strength of newer estimators. Overall the Weibull Curve method predominately outperformed all other methods for estimating the onset and end of flowering populations, while the Midway 7-Day method outperforms others methods in estimating onset and end of individuals flowering. Exceptions to these stem mainly from differences in sample size but also the shape of the flowering distribution. Start and end of individual flowering was best estimated by the Midway 7-Day method, as long as an adequate number of individual remains after applying the 7 day restriction, and otherwise using the Weibull method. While other studies recommend not estimating onset, here I recommend only estimating it with an adequate sample size.

The Weibull method was overall the best method for population onset and end with two exceptions. First, when the total number of flowering presence observations were extremely low (ie. with a total sample size of 10 and percent presence observations 25%) using just the first or last observed flowering date produced better estimates. The first and last observed date have been shown to be bias [@miller-rushing2008, @moussus2010, @bertin2015], yet here it produced the best estimate for these low sample size scenarios. This is due more to the lack of information in this scenario than to any advantage in using first (or last) observed method. This method had an R2 value of 0.28 for onset and 0.15 for end estimates. With such low explanatory value for all methods in this scenario it’s recommended to not estimate flowering onset with extremely low sample sizes. With the highest sample sizes the first and last observed method produced similar results to the Weibull method. Yet this similarity might decrease for species or phenophases which last longer (the total flowering duration here was 39.7 ±6.1 days). As a phenophase lengthens, the chance of observing an individual near the onset or end of the phenophase decreases. Thus the Weibull method would be preferable even with a large sample size. 
Second, when there was a large sample size (50-100) and a small proportion of flowering presence the Logistic or GAM methods performed slightly better than the Weibull Curve. This suggests the Logistic and GAM methods effectively utilize flowering absence observations, but require a large amount of them, relative to presence observations, to accurately describe the phenology.  Both Logistic and GAM methods performed worse as the the proportion of flowering absences decreased, regardless of metric or sample size. The reduction in accuracy was due to increasingly underestimating the onset, and increasingly overestimating the end, as the proportion of flowering absences decreased. If a large amount of flowering absence observations are available then these two methods should be explored for estimating phenology metrics. Absence observations are rare in historic and herbarium based phenology datasets [@], but more common for datasets with status based protocols [@npn]. Given that they could prove useful when presence observations are low they should be emphasized in future data collection efforts.  

The flowering of E. angustifolia over time resembles a normal distribution and choosing several observations of individuals flowering at random, as done here, will produce flowering dates near the peak of flowering. Among the 11 years of data the average time from the true onset to peak was 16 days, and from peak to end of flowering 24 days. The 95% CI of errors for the first occurrence method was in the scenario with a sample size of 10 and proportions of flowering presence 25% was from 0-19 days for onset and -26-0 days for end of flowering. Thus this method is slightly worse than what would be expected statistically.

For estimating the peak of flowering populations the mean flowering method consistently produced the best estimate, even when sample size and proportion of flowering presence was low, 10 and 0.25, respectively. This method has the advantage over the other two methods, the Survival Curve and GAM method, of not requiring flowering absence observations. As noted in other studies the mean flowering method is a reliable method for estimating flowering peak flowering [xxx].

For estimating the start and end of flowering for individual plants the Midway 7-Day method was the best in most cases. The Weibull curve method performed similarly when the absolute number of flowering presence observations was greater than 10. It must be noted that in the vast majority of cases (83-97% depending on the scenario) it was not possible to use the Midway 7-Day method due to lack of individuals with an absence observations within 7 days of the first presence observation. With large enough datasets using this method is still possible even with the restriction [@gerset2016], and it can also be relaxed to have a minimum 15 or 30 day to increase sample size if needed [@taylor2018]. If an insufficient number of individuals results from applying the restriction using the Midway method, than the Weibull method is adequate given enough presence samples.



While the Midway 7-Day method was the best for estimating flowering for individual plants, using the mean of those estimates from a population (Mean Midway 7-Day) did not provide the best population level estimates even with a large sample size. The onset of E. angustifolia flowering for individuals is staggered over time [@ison2014] and the mean of this is not equivalent to the absolute population onset date. For population level estimates other methods discussed above are better. 

 -@moussus2010 found GAM’s to be among the best estimators for detecting phenological shifts among different seasons, yet here the GAM method was not the best performing for pinpointing the exact transition and peak dates. Differences in analysis include -@moussus2010 using a poisson distribution to model simulated count data, while here I used a binomial distribution to model presence/absence data. Here the accuracy of the GAM method decreased as the proportion of absence observations decreased. This could be due to the probability threshold for both onset and end being set as 0.05. It’s possible this threshold could be adjusted to reflect different sampling proportions. It is also possible that the GAM model output, the probability of observing a flower, is not analogous to the total abundance of flowers. General additive models have substantial flexibility [@simpson ref] and further exploration into their use for plant phenology would be beneficial. 

The number of E. angustifolia flowers observed over time resembles a beta distribution, with a quick onset, peak, and gradual decline in number of flowers. The long tail made end estimates more difficult as the probability of observing a flower close to the true end was low. The likeness to a normal distribution allowed for very accurate estimates of peak flowering using the Mean Flowering method. Flowering distributions for most species are thought to have similar properties [@forest2010], but the methods used here may not be appropriate for other phenophases, especially ones which can last significantly longer. For example leafs can be present for several months and .... Fruiting can also be a more drawn out process and methods describing the continuous maturation, as opposed to distinct transition dates, may be more appropriate [@chuine2017]. 

This analysis used data from two scales at a single site, yet research and datasets commonly expand to regional and continental scales [@willis2017, @jones2017]. At larger scales the phenology of a single species may be spread across several weeks. Using observations from across an entire species range is likely  Estimators should be used with caution when combining data across numerous sites. 

